<style>
/* â”€â”€ BLOGGER SIFIRLA â”€â”€ */
html, body {
  margin: 0 !important; padding: 0 !important;
  width: 100% !important; height: 100% !important;
  overflow: hidden !important; background: #1a1a2e !important;
}
body > *:not(#gw-app):not(#gw-music):not(script):not(link):not(style) {
  display: none !important; height: 0 !important;
  pointer-events: none !important; visibility: hidden !important;
}

/* â”€â”€ APP â”€â”€ */
#gw-app {
  position: fixed !important; top:0 !important; left:0 !important;
  width:100vw !important; height:100vh !important;
  z-index: 2147483647 !important;
  display: flex; flex-direction: column;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 14px; background: #f8f9fa; color: #333;
  --accent: #c0392b; --dark: #2c3e50; --bg: #f8f9fa;
  --card: #fff; --border: #ddd; --text: #333;
}
#gw-app[data-theme="dark"] {
  background: #1a1a1a; color: #ecf0f1;
  --bg:#1a1a1a; --card:#2c3e50; --border:#444; --text:#ecf0f1;
}

/* STANDBY */
#gw-standby {
  position:absolute; inset:0; background:rgba(0,0,0,0.9);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  color:white; z-index:999; cursor:pointer; text-align:center; padding:20px;
  backdrop-filter:blur(4px);
}
#gw-standby h2 { margin:20px 0 8px; font-size:1.5rem; }
#gw-standby p  { margin:0; color:#ccc; font-size:14px; }
.gw-pulse-btn {
  width:80px; height:80px; border-radius:50%;
  background:#c0392b; border:none; color:white; font-size:32px;
  cursor:pointer; box-shadow:0 0 0 0 rgba(192,57,43,.7);
  animation:pulse 2s infinite;
  display:flex; align-items:center; justify-content:center;
}
@keyframes pulse {
  0%   { box-shadow:0 0 0 0 rgba(192,57,43,.7); }
  70%  { box-shadow:0 0 0 20px rgba(192,57,43,0); }
  100% { box-shadow:0 0 0 0 rgba(192,57,43,0); }
}

/* HEADER */
#gw-header {
  background:#2c3e50; color:white; flex-shrink:0;
  padding:10px 14px calc(10px + env(safe-area-inset-top));
  display:flex; flex-direction:column; gap:8px; box-sizing:border-box; width:100%;
}
.gw-hrow { display:flex; justify-content:space-between; align-items:center; }
.gw-title { font-weight:700; font-size:1rem; margin:0; }
.gw-tbtn {
  background:none; border:none; color:#f1c40f;
  font-size:1.2rem; cursor:pointer; padding:4px; line-height:1;
}
.gw-sinput {
  width:100%; padding:8px 14px 8px 36px; border-radius:25px; border:none;
  background:rgba(255,255,255,.15); color:white; box-sizing:border-box; font-size:13px;
}
.gw-sinput::placeholder { color:rgba(255,255,255,.55); }
.gw-sinput:focus { outline:none; background:rgba(255,255,255,.25); }
.gw-sbox { position:relative; }
.gw-sico { position:absolute; left:12px; top:50%; transform:translateY(-50%); opacity:.7; font-size:14px; }

/* MAP */
#gw-map {
  flex-shrink:0; width:100%; height:42vh; min-height:160px;
  border-bottom:4px solid #c0392b; position:relative; z-index:1;
}
@supports (height:42dvh) { #gw-map { height:42dvh; } }
.leaflet-popup { max-width:calc(100vw - 30px) !important; }
.leaflet-popup-content-wrapper { max-width:calc(100vw - 40px) !important; border-radius:8px; box-sizing:border-box; }
.leaflet-popup-content { max-width:100% !important; overflow-x:hidden !important; word-break:break-word; }

/* TOUR UI */
#gw-tstatus {
  position:absolute; top:10px; left:50%; transform:translateX(-50%);
  background:rgba(0,0,0,.75); color:white; padding:6px 14px; border-radius:20px;
  font-size:12px; z-index:50; display:none; white-space:nowrap;
  max-width:90%; overflow:hidden; text-overflow:ellipsis;
}
#gw-tctrl {
  position:absolute; bottom:50px; left:50%; transform:translateX(-50%);
  background:rgba(0,0,0,.6); padding:8px; border-radius:30px; z-index:50;
  display:none; gap:8px; flex-wrap:wrap; justify-content:center;
}
#gw-tctrl button {
  background:#c0392b; color:white; border:none; padding:7px 14px;
  border-radius:20px; cursor:pointer; font-size:12px;
}

/* SCROLL */
#gw-scroll {
  flex:1; overflow-y:auto; background:var(--bg);
  padding:10px 12px 90px; box-sizing:border-box;
  -webkit-overflow-scrolling:touch;
}
.gw-chips { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:10px; }
.gw-chip {
  padding:5px 12px; border-radius:20px; font-size:12px; cursor:pointer;
  background:var(--card); border:1px solid var(--border); color:var(--text);
  transition:.2s; white-space:nowrap;
}
.gw-chip:hover, .gw-chip.on { background:#c0392b; color:white; border-color:#c0392b; }

/* CARDS */
.gw-card {
  background:var(--card); border-radius:10px; margin-bottom:10px;
  border:1px solid var(--border); overflow:hidden; box-shadow:0 2px 4px rgba(0,0,0,.05);
}
.gw-ch {
  padding:12px 14px; font-weight:600; cursor:pointer;
  border-left:5px solid #c0392b; display:flex; justify-content:space-between; align-items:center;
  font-size:13px;
}
.gw-cb { max-height:0; overflow:hidden; transition:max-height .4s ease; }
.gw-cb.open { max-height:999999px; }

.gw-pt { padding:12px 14px; border-bottom:1px solid var(--border); }
.gw-pt-name { font-weight:600; margin-bottom:3px; font-size:13px; }
.gw-pt-desc { font-size:12px; opacity:.75; margin-bottom:8px; line-height:1.4; }
.gw-intro {
  font-size:12px; background:#fff3cd; border-left:4px solid #e67e22;
  border-radius:5px; padding:9px; margin:6px 0; line-height:1.5;
}
#gw-app[data-theme="dark"] .gw-intro { background:#3a2e00; }
.gw-meta { font-size:12px; margin:6px 0; opacity:.8; }
.gw-acts { display:flex; gap:6px; margin:8px 0; flex-wrap:wrap; }
.gw-abtn {
  flex:1; min-width:60px; padding:7px 5px; border-radius:6px; font-size:11px; font-weight:600;
  text-align:center; text-decoration:none; border:none; cursor:pointer;
  display:flex; align-items:center; justify-content:center; gap:3px;
}
.ab-map   { background:#ecf0f1; color:#2c3e50; }
.ab-earth { background:#e8f5e9; color:#1b5e20; }
.ab-share { background:#e3f2fd; color:#0d47a1; }

/* READING */
.gw-rh {
  font-weight:700; font-size:12px; color:#2c3e50; padding:7px 0;
  border-bottom:2px solid #c0392b; margin:12px 0 8px;
}
#gw-app[data-theme="dark"] .gw-rh { color:#ecf0f1; }
.gw-paper {
  margin-bottom:12px; padding:9px; border-left:4px solid #c0392b;
  border-radius:5px; background:#fff8f8; font-size:12px; line-height:1.5;
}
#gw-app[data-theme="dark"] .gw-paper { background:#2a1a1a; }
.gw-pq    { font-weight:700; color:#c0392b; font-size:11px; }
.gw-ptit  { font-weight:600; margin:3px 0; font-size:12px; }
.gw-pdoi  { color:#666; margin-bottom:3px; }
.gw-pdoi a { color:#c0392b; word-break:break-all; }
.gw-play  { font-style:italic; color:var(--text); }

/* COMMENTS */
.gw-cmts { margin-top:8px; padding:6px; background:rgba(0,0,0,.03); border-radius:5px; }
.gw-cmts h5 { margin:3px 0 6px; font-size:12px; }
.gw-cmts textarea {
  width:100%; box-sizing:border-box; font-size:12px; padding:5px;
  border:1px solid var(--border); border-radius:4px; resize:vertical;
}
.gw-cmts button {
  margin-top:4px; padding:4px 10px; background:#c0392b; color:white;
  border:none; border-radius:4px; cursor:pointer; font-size:12px;
}
.gw-clist { max-height:80px; overflow-y:auto; margin-bottom:5px; }
.gw-citem { font-size:12px; padding:2px 0; border-bottom:1px solid var(--border); }

/* MUSIC BAR */
#gw-music {
  position:fixed; bottom:0; left:0; width:100%; box-sizing:border-box;
  background:rgba(10,10,10,.97); backdrop-filter:blur(10px);
  padding:9px 14px calc(9px + env(safe-area-inset-bottom));
  display:flex; align-items:center; justify-content:space-between;
  color:white; z-index:2147483646; border-top:1px solid #333;
}
.gw-mctrl {
  width:38px; height:38px; border-radius:50%; border:none;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:16px;
}

/* RUPTURE INFO */
.gw-ri { margin-top:7px; background:#c0392b; color:white; padding:7px; border-radius:5px; font-size:12px; }
.guide-popup .leaflet-popup-content-wrapper { background:rgba(0,0,0,.88); color:white; }
.guide-popup .leaflet-popup-tip           { background:rgba(0,0,0,.88); }
.gw-snippet {
  font-style:italic; font-weight:600; margin-bottom:8px; color:#ffebee;
  background:rgba(192,57,43,.3); padding:8px; border-radius:6px; line-height:1.4; font-size:13px;
}
</style>



<!-- ANA UYGULAMA -->
<div id="gw-app">

  <!-- Standby -->
  <div id="gw-standby" onclick="gwStart()">
    <button class="gw-pulse-btn">â–¶</button>
    <h2>ğŸŒ Deprem GÃ¶Ã§Ã¼ Geowalk</h2>
    <p>Kuzey Anadolu FayÄ± â€” 1939 â†’ 1999<br>BaÅŸlamak iÃ§in dokun veya tÄ±kla</p>
  </div>

  <!-- Header -->
  <div id="gw-header">
    <div class="gw-hrow">
      <h1 class="gw-title">ğŸš DEPREM GÃ–Ã‡Ãœ GEOWALK</h1>
      <button class="gw-tbtn" onclick="gwTheme()" title="Tema deÄŸiÅŸtir" id="gw-ticon">ğŸŒ™</button>
    </div>
    <div class="gw-sbox">
      <span class="gw-sico">ğŸ”</span>
      <input class="gw-sinput" type="text" id="gw-q"
        placeholder="Ara: 1939, sag pond, Ladik, offset..."
        oninput="gwFilter(this.value)">
    </div>
  </div>

  <!-- Harita -->
  <div id="gw-map">
    <div id="gw-tstatus"></div>
    <div id="gw-tctrl" style="display:none;">
      <button onclick="gwPause()">â¸ Durdur</button>
      <button onclick="gwNext()">â­ Sonraki</button>
      <button id="gw-rbtn" onclick="gwResume()" style="display:none;">â–¶ Devam</button>
    </div>
  </div>

  <!-- Scroll -->
  <div id="gw-scroll">
    <div class="gw-chips">
      <div class="gw-chip on" onclick="gwReset()">ğŸ  Hepsi</div>
      <div class="gw-chip" onclick="gwLocate()">ğŸ“ Konumum</div>
      <div class="gw-chip" onclick="gwRuptures()">ğŸŸ¥ KÄ±rÄ±k HattÄ±</div>
      <div class="gw-chip" style="background:#27ae60;color:white;border-color:#27ae60" onclick="gwTour()">â–¶ Sanal Tur</div>
    </div>
    <div id="gw-cards"></div>
  </div>

</div><!-- #gw-app -->

<!-- MÃ¼zik barÄ± â€” body'de direkt, fixed -->
<div id="gw-music">
  <div>
    <div style="font-weight:700;color:#e74c3c;font-size:12px;">ğŸ“» Anadolu Sesi</div>
    <div id="gw-tname" style="font-size:11px;opacity:.7;">Uzun Ä°nce Bir YoldayÄ±m</div>
  </div>
  <div style="display:flex;gap:8px;">
    <button class="gw-mctrl" style="background:#34495e;" onclick="gwVoice()">ğŸ™</button>
    <button class="gw-mctrl" id="gw-pbtn" style="background:#c0392b;" onclick="gwMusic()">â–¶</button>
  </div>
</div>

<!-- Leaflet JS â€” Ã§oklu CDN fallback -->
<script>
// Leaflet yÃ¼kleme â€” 3 farklÄ± CDN dene

</script>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BLOGGER KAPATMA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function() {
  function hide() {
    // body'deki tÃ¼m Blogger elementlerini gizle
    Array.from(document.body.children).forEach(function(el) {
      if (el.id !== 'gw-app' && el.id !== 'gw-music' &&
          el.tagName !== 'SCRIPT' && el.tagName !== 'LINK' && el.tagName !== 'STYLE') {
        el.style.cssText = 'display:none!important;visibility:hidden!important;height:0!important;' +
          'overflow:hidden!important;position:absolute!important;top:-9999px!important;pointer-events:none!important;';
      }
    });
    // Bilinen Blogger seÃ§icileri
    ['.header-outer','.header-inner','.header-wrapper','.header-wrapper-inner',
     '.footer-outer','.footer-inner','.sidebar-outer','.sidebar-wrapper',
     '.sidebar-container','.sidebar-right-1','.tabs-outer','.page-header',
     '#header','#footer','.blog-pager','#blog-pager','.attribution-gadget',
     '.post-header','.post-footer','.post-title','.post-title-link',
     '.byline','.post-share-buttons','.reactions','.post-comment-link',
     '#navbar-iframe','.navbar','.navbar-iframe'
    ].forEach(function(s) {
      document.querySelectorAll(s).forEach(function(el) {
        el.style.cssText = 'display:none!important;height:0!important;overflow:hidden!important;';
      });
    });
  }
  hide();
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', hide);
  }
  if (window.MutationObserver) {
    var obs = new MutationObserver(hide);
    obs.observe(document.body, { childList: true });
    setTimeout(function() { obs.disconnect(); }, 8000);
  }
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// VERÄ°
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var PTS = [
  { name:'1939 Erzincan Depremi',       lat:39.77, lon:39.58, desc:'Mw 7.9 â€“ 27 AralÄ±k 1939. ~33.000 can kaybÄ±. YÃ¼zey kÄ±rÄ±ÄŸÄ± ~360 km, max saÄŸ yanal atÄ±m ~10.5 m.' },
  { name:'1942 Niksar-Erbaa Depremi',   lat:40.87, lon:36.47, desc:'Mw 7.0 â€“ 20 AralÄ±k 1942. Erbaa ovasÄ±nda offset tarlalar ve sag pond\'lar.' },
  { name:'1943 Tosya-Ladik Depremi',    lat:40.87, lon:33.65, desc:'Mw 7.6 â€“ 26 KasÄ±m 1943. Ladik GÃ¶lÃ¼ kÄ±yÄ±sÄ±nda deformasyon ve gÃ¶l ikiye bÃ¶lÃ¼nmesi.' },
  { name:'1944 Bolu-Gerede Depremi',    lat:40.81, lon:32.23, desc:'Mw 7.3 â€“ 1 Åubat 1944. Gerede ovasÄ±nda step-over zonlarÄ± ve ~3 m saÄŸ yanal atÄ±m.' },
  { name:'1957 Abant Depremi',          lat:40.95, lon:31.28, desc:'Mw 7.1 â€“ 26 MayÄ±s 1957. Abant tektonik gÃ¶lÃ¼ ve fay Ã§iÃ§ek yapÄ±larÄ±.' },
  { name:'1967 Mudurnu Vadisi Depremi', lat:40.78, lon:30.40, desc:'Mw 7.1 â€“ 22 Temmuz 1967. AdapazarÄ± ovasÄ±nda sÄ±vÄ±laÅŸma ve deformasyon izleri.' },
  { name:'1999 GÃ¶lcÃ¼k-DÃ¼zce Depremi',  lat:40.70, lon:29.91, desc:'Mw 7.4+7.2 â€“ 1999. Hersek deltasÄ±, Eften GÃ¶lÃ¼ ve AkyazÄ±-GÃ¶lyaka\'da max 5.2 m atÄ±m.' }
];

var E3D = [
  'https://earth.google.com/web/@39.77,39.58,2500a,90h,65t,0r',
  'https://earth.google.com/web/@40.87,36.47,1200a,45h,55t,0r',
  'https://earth.google.com/web/@40.87,33.65,1800a,180h,60t,0r',
  'https://earth.google.com/web/@40.81,32.23,1500a,270h,70t,0r',
  'https://earth.google.com/web/@40.95,31.28,2000a,0h,50t,0r',
  'https://earth.google.com/web/@40.78,30.40,2200a,135h,60t,0r',
  'https://earth.google.com/web/@40.70,29.91,1800a,225h,45t,0r'
];

var SNIP = [
  '900 km\'lik gÃ¶Ã§Ã¼n baÅŸlangÄ±Ã§ ateÅŸi â€“ Erzincan\'da 360 km\'lik hat doÄŸudan batÄ±ya aÃ§Ä±ldÄ±.',
  'Erbaa ovasÄ±nda offset tarlalar ve sag pond\'lar oluÅŸtu â€“ fay hareketi burada somutlaÅŸtÄ±.',
  'Ladik GÃ¶lÃ¼\'nÃ¼n kÄ±yÄ±sÄ± bu depremle deÄŸiÅŸti â€“ gÃ¶l ikiye bÃ¶lÃ¼ndÃ¼, izler kaldÄ±.',
  'Gerede step-over zonu KAFZ\'nin en karmaÅŸÄ±k morfolojisidir â€“ Ã§Ã¶kÃ¼ntÃ¼ basenleri belirgindir.',
  'Abant tektonik gÃ¶lÃ¼ ve fay Ã§iÃ§ek yapÄ±larÄ± oluÅŸtu â€“ vadi morfolojisi deÄŸiÅŸti.',
  'Mudurnu\'da atÄ±m izleri netleÅŸti â€“ AdapazarÄ± ovasÄ±nda sÄ±vÄ±laÅŸma deformasyonlarÄ± gÃ¶rÃ¼ldÃ¼.',
  'Hersek DeltasÄ± deformasyonu DEM\'de en net kÄ±rÄ±ktÄ±r â€“ Marmara\'ya stres transferi baÅŸladÄ±.'
];

var RUPS = {
  e39:[[39.77,39.58],[39.85,39.90],[40.00,38.50],[40.10,37.80]],
  e42:[[40.87,36.47],[40.90,36.40]],
  e43:[[40.87,33.65],[40.95,33.50]],
  e44:[[40.81,32.23],[40.85,32.10]],
  e57:[[40.95,31.28],[41.00,31.20]],
  e67:[[40.78,30.40],[40.85,30.30]],
  e99:[[40.70,29.91],[40.75,30.00],[40.90,31.00]]
};

var READING = [
  { intro:'<strong>1939 Erzincan â€“ KÄ±rÄ±k HattÄ± (~360 km):</strong> SaÄŸ yanal atÄ±m bazÄ± noktalarda 10 m\'yi aÅŸmÄ±ÅŸtÄ±r. DEM gÃ¶rÃ¼ntÃ¼sÃ¼nde tarlalar, dereler ve yollar bir cetvel gibi saÄŸa kaymÄ±ÅŸ gÃ¶rÃ¼nÃ¼r. Bu hareket tek dÃ¼z bir Ã§izgide deÄŸil geniÅŸ bir kÄ±rÄ±k kuÅŸaÄŸÄ±nda gerÃ§ekleÅŸmiÅŸtir.',
    papers:[
      {q:'Q1',j:'Nature',doi:'10.1038/375479a0',t:'Seismic and aseismic slip on the Northern Anatolian Fault',l:'Fay bazen yavaÅŸ sessizce, bazen ani sÄ±Ã§rayarak kayar. Arazideki her kÄ±rÄ±k izi bu iki hareketin birikmiÅŸ Ã¼rÃ¼nÃ¼dÃ¼r.'},
      {q:'Q2',j:'Geophys. J. Int.',doi:'10.1046/j.1365-246X.2003.01904.x',t:'The 1939 Erzincan earthquake: fault geometry and rupture propagation',l:'KÄ±rÄ±ÄŸÄ±n doÄŸudan batÄ±ya "koÅŸtuÄŸunu" ve farklÄ± kollar aÃ§tÄ±ÄŸÄ±nÄ± gÃ¶steriyor. Haritadaki karmaÅŸÄ±k kÄ±rÄ±k yapÄ±sÄ±nÄ± anlamak iÃ§in temel kaynak.'},
      {q:'Q3',j:'Turkish J. Earth Sci.',doi:'10.3906/yer-1501-23',t:'Surface rupture and paleoseismology of the 1939 Erzincan earthquake',l:'Hendek kazÄ±sÄ±yla 1939 Ã¶ncesi deprem izleri de bulunmuÅŸ. AynÄ± hat geÃ§miÅŸte de kÄ±rÄ±lmÄ±ÅŸ â€” tarihsel bellek burada gizli.'},
      {q:'Q4',j:'Bulletin MRE',doi:'10.19111/bulletinofmre.300501',t:'Morphotectonic analysis of the NAF Zone near Erzincan',l:'Yamuk akarsu kanallarÄ± ve dÃ¼zleÅŸmiÅŸ ovalar yÃ¼zyÄ±llÄ±k fay hareketinin eseridir. Haritaya bakarken bunlarÄ± artÄ±k gÃ¶rebilirsin.'}
    ]
  },
  { intro:'<strong>1942 Niksar-Erbaa â€“ Offset Tarlalar ve Sag Pond\'lar (~50 km):</strong> Tarlalar ve yollar saÄŸa kaymÄ±ÅŸ, Ã§ukur alanlarda sag pond gÃ¶letler oluÅŸmuÅŸtur. Sag pond: fay kollarÄ± arasÄ±nda zemin Ã§Ã¶ktÃ¼ÄŸÃ¼nde su biriken doÄŸal Ã§ukur.',
    papers:[
      {q:'Q1',j:'Geophys. Res. Lett.',doi:'10.1029/2000GL011855',t:'Slip rate and seismic hazard on the northern strand of the NAF Zone',l:'YÄ±lda birkaÃ§ cm kayma birikince yÃ¼zyÄ±llar sonra bÃ¼yÃ¼k deprem geliyor. Niksar bÃ¶lgesinin kÄ±rÄ±k hÄ±z Ã¶lÃ§Ã¼mleri burada.'},
      {q:'Q2',j:'Quaternary Int.',doi:'10.1016/j.quaint.2009.01.008',t:'Geomorphic evidence for Holocene earthquakes: offsets, sag ponds and fault scarps',l:'KaymÄ±ÅŸ Ã§it, yamuk dere, Ã§ukur gÃ¶let â€” arazide neye bakacaÄŸÄ±nÄ± bu makale Ã¶ÄŸretiyor.'},
      {q:'Q3',j:'Annals of Geophysics',doi:'10.4401/ag-3547',t:'Paleoseismological trench study across the NAF at Gerede',l:'Hendek kazÄ±sÄ±ndaki eski toprak katmanlarÄ± geÃ§miÅŸ depremlerin izlerini saklÄ±yor. Niksar hattÄ±nÄ± anlamak iÃ§in gÃ¼Ã§lÃ¼ karÅŸÄ±laÅŸtÄ±rma.'},
      {q:'Q4',j:'J. Geodynamics',doi:'10.1016/j.jog.2011.08.002',t:'Tectonic geomorphology of the Niksar-Erbaa segment, NAF Zone',l:'OvanÄ±n bir kenarÄ± neden yÃ¼ksek? Dere neden sarp dÃ¶ndÃ¼? Bu Ã§alÄ±ÅŸma tÃ¼m sorularÄ± yanÄ±tlÄ±yor.'}
    ]
  },
  { intro:'<strong>1943 Tosya-Ladik â€“ GÃ¶l Deformasyonu (~280 km):</strong> Ladik GÃ¶lÃ¼\'nÃ¼n kÄ±yÄ± Ã§izgisi deÄŸiÅŸmiÅŸ, bazÄ± bÃ¶lÃ¼mler alÃ§almÄ±ÅŸ ya da yÃ¼kselmiÅŸtir. DEM\'de gÃ¶lÃ¼n yanÄ±ndaki dÃ¼z Ã§izgi fay geÃ§iÅŸini ele verir.',
    papers:[
      {q:'Q1',j:'BSSA',doi:'10.1785/0120160062',t:'Coseismic deformation and kinematics of the 1943 Tosya earthquake',l:'Deprem anÄ±ndaki zemin hareketi Ã¶lÃ§Ã¼lmÃ¼ÅŸ. GÃ¶lÃ¼n kÄ±yÄ±sÄ± neden aniden deÄŸiÅŸti ve sahada nasÄ±l gÃ¶rÃ¼nÃ¼yor.'},
      {q:'Q2',j:'J. Seismology',doi:'10.1023/A:1026516314017',t:'Lake shoreline deformation: 1943 NAF earthquake, Ladik Lake',l:'Eski fotoÄŸraflarla kÄ±yaslayarak Ladik GÃ¶lÃ¼\'ndeki kÄ±yÄ± deÄŸiÅŸimi belgelenmiÅŸ. "GÃ¶lÃ¼n ikiye bÃ¶lÃ¼nmesi" efsanesinin bilimsel temeli.'},
      {q:'Q3',j:'Geodinamica Acta',doi:'10.1080/09853111.2004.10600592',t:'NAF displacement and slip rates from geomorphic analysis, Tosya segment',l:'KÃ¼Ã§Ã¼k vadi sapmalarÄ± aslÄ±nda binlerce yÄ±llÄ±k birikimin Ã¼rÃ¼nÃ¼. Bu makale bunu somutlaÅŸtÄ±rÄ±yor.'},
      {q:'Q4',j:'Turkish J. Earth Sci.',doi:'10.3906/yer-1801-15',t:'Sedimentary record of earthquake-triggered changes, Ladik Lake',l:'GÃ¶lÃ¼n tabanÄ±ndaki Ã§amur katmanlarÄ± doÄŸanÄ±n kendi deprem arÅŸivi. 1943 izi karot Ã¶rneklerinde birebir okunuyor.'}
    ]
  },
  { intro:'<strong>1944 Bolu-Gerede â€“ Step-Over Zonu (~190 km):</strong> Gerede\'deki fay tek Ã§izgi deÄŸil paralel kollar halinde ilerler. KollarÄ±n birinden diÄŸerine atladÄ±ÄŸÄ± "step-over" noktalarÄ±nda Ã§Ã¶kÃ¼ntÃ¼ havzalarÄ± oluÅŸur â€” dÃ¼z ovalar ve bataklÄ±klar bunlarÄ±n yÃ¼zey yansÄ±malarÄ±dÄ±r.',
    papers:[
      {q:'Q1',j:'J. Geophys. Res.',doi:'10.1029/2003JB002618',t:'Paleoseismology of the NAF at Gerede: recurrence of large earthquakes',l:'Hendek kazÄ±sÄ± geÃ§miÅŸ depremlerin katmanlarÄ±nÄ± ortaya koydu. 1944 "sÄ±rasÄ± gelen" depremdi.'},
      {q:'Q2',j:'Tectonophysics',doi:'10.1016/j.tecto.2010.09.013',t:'Pull-apart basins and step-over geometry along the 1944 rupture',l:'Fay neden dÃ¼z Ã§izgi deÄŸil? Sapmalar neden Ã§Ã¶kÃ¼ntÃ¼ oluÅŸturur? OvanÄ±n ortasÄ±ndaki Ã§ukurlarÄ±n sÄ±rrÄ± burada.'},
      {q:'Q3',j:'Annali di Geofisica',doi:'10.4401/ag-3559',t:'Slip distribution of the 1944 Bolu-Gerede earthquake',l:'FarklÄ± noktalarda farklÄ± kayma miktarlarÄ±. Koldan kola atlayan kÄ±rÄ±k enerjiyi eÅŸitsiz daÄŸÄ±ttÄ±.'},
      {q:'Q4',j:'Bulletin MRE',doi:'10.19111/bulletinofmre.413987',t:'Geomorphic response to the 1944 NAF rupture in the Gerede Basin',l:'Havadan fotoÄŸraflar ve arazi Ã¶lÃ§Ã¼mleriyle kÃ¼Ã§Ã¼k kÄ±rÄ±k basamaklarÄ± belgelenmiÅŸ. Tarlalar arasÄ±nda hÃ¢lÃ¢ gÃ¶rÃ¼nÃ¼yor.'}
    ]
  },
  { intro:'<strong>1957 Abant â€“ Tektonik GÃ¶l ve Ã‡iÃ§ek YapÄ±sÄ±:</strong> Abant GÃ¶lÃ¼ fay tarafÄ±ndan yaratÄ±lmÄ±ÅŸtÄ±r â€” saÄŸ yanal fayÄ±n pull-apart havzasÄ±. 1957 depremi "Ã§iÃ§ek yapÄ±sÄ±" (flower structure) denilen fay kollanmasÄ±nÄ± yeniden canlandÄ±rdÄ±. DEM\'de vadi aÄŸÄ±nÄ±n asimetrisi dikkat Ã§ekicidir.',
    papers:[
      {q:'Q1',j:'Geomorphology',doi:'10.1016/j.geomorph.2014.04.005',t:'Tectonic origin and Quaternary evolution of Abant lake basin, NAF Zone',l:'GÃ¶lÃ¼n basamaklÄ± kÄ±yÄ±larÄ±, derin sularÄ± ve asimetrik ÅŸekli â€” hepsinin altÄ±nda tektonik bir hikÃ¢ye. GerÃ§ek yaratÄ±cÄ±: fay.'},
      {q:'Q2',j:'J. Structural Geology',doi:'10.1016/j.jsg.2012.08.007',t:'Flower structure and transpressional tectonics along the NAF at Abant',l:'Fay derinlikten yÃ¼zeye Ã§iÃ§ek gibi kollanÄ±r. Sahada gÃ¶rdÃ¼ÄŸÃ¼n paralel Ã§izgiler bu Ã§iÃ§eÄŸin yapraklarÄ±dÄ±r.'},
      {q:'Q3',j:'Turkish J. Earth Sci.',doi:'10.3906/yer-0903-28',t:'The 1957 Abant earthquake and morphological evolution of Mudurnu Valley',l:'Vadinin dÃ¼z gÃ¶rÃ¼nmesinin nedeni fayÄ±n uzun vadeli oyma iÅŸi. Bu makale bunu adÄ±m adÄ±m anlatÄ±yor.'},
      {q:'Q4',j:'Quaternary Sci. Rev.',doi:'10.1016/j.quascirev.2017.09.014',t:'Abant Lake as a paleoseismic archive',l:'GÃ¶lÃ¼n tabanÄ± binlerce yÄ±llÄ±k deprem tarihini saklÄ±yor. Hem manzara hem deprem kÃ¼tÃ¼phanesi.'}
    ]
  },
  { intro:'<strong>1967 Mudurnu Vadisi â€“ SÄ±vÄ±laÅŸma ve AtÄ±m Ä°zleri (~80 km):</strong> SapkÄ±n dereler, kaymÄ±ÅŸ Ã§itler ve yerinden oynamÄ±ÅŸ yol kenarlarÄ± bugÃ¼n hÃ¢lÃ¢ gÃ¶rÃ¼lebilir. AdapazarÄ±\'nda gevÅŸek zemin sÄ±vÄ±laÅŸma yaÅŸar: zemin su gibi akar, binalar batar. Bu deprem 1999\'un provasÄ±ydÄ±.',
    papers:[
      {q:'Q1',j:'BSSA',doi:'10.1785/0120000226',t:'Surface rupture of the 1967 Mudurnu Valley earthquake vs. 1999 Izmit',l:'32 yÄ±l arayla aynÄ± fay hattÄ±, benzer atÄ±m. FayÄ±n "belleÄŸi" var â€” aynÄ± zayÄ±f hattÄ± tekrar tekrar kÄ±rÄ±yor.'},
      {q:'Q2',j:'Tectonophysics',doi:'10.1016/S0040-1951(00)00091-3',t:'Geomorphic evidence for active faulting along Mudurnu Valley segment',l:'Uydu gÃ¶rÃ¼ntÃ¼leri + saha Ã§alÄ±ÅŸmasÄ±: kaymÄ±ÅŸ dereler, basamaklÄ± arazi, fay sÄ±rtlarÄ±. Sahaya Ã§Ä±kÄ±nca neye bakacaÄŸÄ±nÄ± gÃ¶steriyor.'},
      {q:'Q3',j:'Engineering Geology',doi:'10.1016/j.enggeo.2005.09.015',t:'Liquefaction potential and site effects in the 1967 Mudurnu earthquake',l:'SÄ±vÄ±laÅŸma: zemin depremde su gibi akmaya baÅŸlar. AdapazarÄ± sahasÄ± bu makaleyle anlaÅŸÄ±lÄ±r.'},
      {q:'Q4',j:'Bulletin MRE',doi:'10.19111/bulletinofmre.367921',t:'Offset stream channels and slip rates along the 1967 NAF rupture',l:'"L" ÅŸeklinde akan dere fayÄ±n geÃ§tiÄŸini sÃ¶yler. SapkÄ±n kanallardan yÄ±llÄ±k kayma hÄ±zÄ± hesaplanmÄ±ÅŸ.'}
    ]
  },
  { intro:'<strong>1999 GÃ¶lcÃ¼k-DÃ¼zce â€“ KÄ±rÄ±lma GÃ¶Ã§Ã¼nÃ¼n Finali:</strong> Mw 7.4 (17 AÄŸustos) + Mw 7.2 (12 KasÄ±m). Hersek DeltasÄ± anÄ±nda kaydÄ±, kÄ±yÄ± Ã§izgisi deÄŸiÅŸti. AkyazÄ±-GÃ¶lyaka\'da max 5.2 m atÄ±m Ã¶lÃ§Ã¼ldÃ¼. DEM ve uydu gÃ¶rÃ¼ntÃ¼lerinde kÄ±rÄ±k hattÄ± Ã§arpÄ±cÄ± biÃ§imde gÃ¶rÃ¼nÃ¼r.',
    papers:[
      {q:'Q1',j:'BSSA',doi:'10.1785/0120000577',t:'Fault geometry and slip of the 1999 Izmit earthquake: InSAR+GPS',l:'Uydu radarÄ±yla her noktada ne kadar kaydÄ±ÄŸÄ± haritalandÄ±. Depremin coÄŸrafi imzasÄ± â€” sahada gÃ¶rdÃ¼ÄŸÃ¼n her iz burada.'},
      {q:'Q2',j:'Geophys. Res. Lett.',doi:'10.1029/1999GL010775',t:'The 1999 Izmit and DÃ¼zce earthquakes: rupture and fault planes',l:'Ä°ki deprem birbirini nasÄ±l tetikledi? GÃ¶lcÃ¼k\'ten 87 gÃ¼n sonra neden DÃ¼zce kÄ±rÄ±ldÄ±? YanÄ±t burada.'},
      {q:'Q3',j:'Earth Planet. Sci. Lett.',doi:'10.1016/S0012-821X(00)00185-8',t:'Hersek Delta coseismic deformation during the 1999 Izmit earthquake',l:'Delta depremin fotoÄŸrafÄ±nÄ± Ã§ekti â€” kÄ±yÄ± anÄ±nda deÄŸiÅŸti. DEM\'de de net gÃ¶rÃ¼nen bu deÄŸiÅŸim en Ã§arpÄ±cÄ± doÄŸal belgelerden.'},
      {q:'Q4',j:'Geophys. J. Int.',doi:'10.1046/j.1365-246X.2002.01801.x',t:'Post-seismic deformation and stress transfer after the 1999 Marmara earthquakes',l:'Depremden sonra zemin yÄ±llarca sessizce hareket etti. Marmara altÄ±na aktarÄ±lan stres Ä°stanbul riskini artÄ±rdÄ±.'}
    ]
  }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UYGULAMA Ä°NÄ°T
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var gwMap = null, gwMarkerLayer = null, gwRupLayers = [], gwUserMk = null;
var gwTourIdx = 0, gwTourOn = false, gwTourTimer = null;

function initApp(hasLeaflet) {
  // Harita
  if (hasLeaflet) {
    gwMap = L.map('gw-map', { center:[40.5,35.0], zoom:7 });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
      { attribution:'Â© OpenStreetMap' }).addTo(gwMap);
    L.tileLayer('https://tiles.wmflabs.org/hillshading/{z}/{x}/{y}.png',
      { opacity:0.4, attribution:'Hillshade' }).addTo(gwMap);
    gwMarkerLayer = L.layerGroup().addTo(gwMap);
    PTS.forEach(function(pt, i) {
      var mk = L.marker([pt.lat,pt.lon]).addTo(gwMarkerLayer);
      mk.bindPopup(
        '<b>'+pt.name+'</b><br><small>'+pt.desc+'</small>'+
        '<div class="gw-ri">DEM hillshade ile fay izlerini inceleyin.</div>'+
        '<a href="'+E3D[i]+'" target="_blank" style="display:block;margin-top:8px;padding:8px;background:#c0392b;color:white;text-align:center;border-radius:5px;text-decoration:none;">ğŸŒ 3D Earth\'te Ä°ncele</a>'
      );
    });
  }

  // KartlarÄ± render et
  renderCards();
}

function renderCards() {
  var html = '<div class="gw-card">';
  html += '<div class="gw-ch" onclick="this.nextElementSibling.classList.toggle(\'open\')">ğŸ”´ Kuzey Anadolu FayÄ± Deprem GÃ¶Ã§Ã¼ (1939â€“1999) &nbsp;â–¼</div>';
  html += '<div class="gw-cb open">';

  PTS.forEach(function(pt, i) {
    var rd = READING[i];
    var ph = rd.papers.map(function(p) {
      return '<div class="gw-paper">'+
        '<div class="gw-pq">'+p.q+' &nbsp;|&nbsp; '+p.j+'</div>'+
        '<div class="gw-ptit">'+p.t+'</div>'+
        '<div class="gw-pdoi">DOI: <a href="https://doi.org/'+p.doi+'" target="_blank">'+p.doi+'</a></div>'+
        '<div class="gw-play">'+p.l+'</div>'+
      '</div>';
    }).join('');

    html += '<div class="gw-pt" data-s="'+pt.name.toLowerCase()+' '+pt.desc.toLowerCase()+'">';
    html += '<div class="gw-pt-name">'+pt.name+'</div>';
    html += '<div class="gw-pt-desc">'+pt.desc+'</div>';
    html += '<div class="gw-intro">'+rd.intro+'</div>';
    html += '<div class="gw-meta">ğŸ“ Rota: ~10-20 km &nbsp;â€¢&nbsp; â± 5-8 saat &nbsp;â€¢&nbsp; ğŸ” Orta-Zor &nbsp;â€¢&nbsp; ğŸ—º DEM hillshade</div>';
    html += '<div class="gw-acts">';
    html += '<button class="gw-abtn ab-map" onclick="gwFly('+pt.lat+','+pt.lon+')">ğŸ“ Haritaya Git</button>';
    html += '<a href="'+E3D[i]+'" target="_blank" class="gw-abtn ab-earth">ğŸŒ 3D Earth</a>';
    html += '<button class="gw-abtn ab-share" onclick="gwShare(\''+pt.name+'\')">ğŸ”— PaylaÅŸ</button>';
    html += '</div>';
    html += '<div class="gw-rh">ğŸ“˜ Suggested for Reading (SCI Q1â€“Q4)</div>';
    html += ph;
    html += '<div class="gw-cmts"><h5>Yorumlar</h5>';
    html += '<div class="gw-clist" id="cl'+i+'"></div>';
    html += '<textarea id="ci'+i+'" rows="2" placeholder="Yorum yazÄ±n..."></textarea>';
    html += '<button onclick="gwCmt('+i+')">GÃ¶nder</button></div>';
    html += '</div>'; // .gw-pt
  });

  html += '</div></div>'; // .gw-cb .gw-card
  document.getElementById('gw-cards').innerHTML = html;
}

// â”€â”€ TUR â”€â”€
function gwTour() {
  if (gwTourOn || !gwMap) return;
  gwTourOn = true; gwTourIdx = 0;
  gwTourUI(); gwTourStep();
}
function gwTourStep() {
  if (!gwTourOn || gwTourIdx >= PTS.length) { gwTourEnd(); return; }
  var pt = PTS[gwTourIdx];
  gwMap.flyTo([pt.lat,pt.lon], 10, {duration:3});
  L.popup({autoClose:false,closeOnClick:false,className:'guide-popup'})
    .setLatLng([pt.lat,pt.lon])
    .setContent('<div class="gw-snippet">'+SNIP[gwTourIdx]+'</div>'+
      '<strong>'+pt.name+'</strong><br><small>'+pt.desc+'</small><br><br>'+
      '<a href="'+E3D[gwTourIdx]+'" target="_blank" onclick="gwPause()" '+
      'style="display:inline-block;padding:9px 14px;background:#c0392b;color:white;'+
      'text-decoration:none;border-radius:7px;font-weight:bold;">ğŸŒ 3D Earth\'te Ä°ncele</a>')
    .openOn(gwMap);
  gwTourIdx++;
  gwTourUI();
  gwTourTimer = setTimeout(gwTourStep, 9000);
}
function gwNext() { clearTimeout(gwTourTimer); gwTourStep(); }
function gwPause() {
  clearTimeout(gwTourTimer); gwTourOn = false; gwTourUI();
  if (gwMap) gwMap.closePopup();
  document.getElementById('gw-rbtn').style.display = 'inline-block';
}
function gwResume() {
  document.getElementById('gw-rbtn').style.display = 'none';
  gwTourOn = true; gwTourStep();
}
function gwTourEnd() {
  gwTourOn = false; clearTimeout(gwTourTimer); gwTourUI();
  if (gwMap) {
    gwMap.closePopup();
    gwMap.setView([40.5,35.0],7);
    L.popup().setLatLng([40.5,35.0])
      .setContent('<strong>âœ… Tur TamamlandÄ±!</strong><br><br>1939â€“1999 arasÄ±nda ~900 km\'lik KAFZ kÄ±rÄ±lmasÄ± batÄ±ya gÃ¶Ã§ etti.')
      .openOn(gwMap);
  }
}
function gwTourUI() {
  var st = document.getElementById('gw-tstatus');
  var tc = document.getElementById('gw-tctrl');
  if (gwTourOn) {
    var idx = Math.min(gwTourIdx, PTS.length-1);
    st.textContent = 'Tur: '+PTS[idx].name+' ('+gwTourIdx+'/'+PTS.length+')';
    st.style.display = 'block'; tc.style.display = 'flex';
  } else { st.style.display = 'none'; tc.style.display = 'none'; }
}

// â”€â”€ HARÄ°TA YARDIMCÄ±LAR â”€â”€
function gwFly(lat,lon) { if (gwMap) gwMap.setView([lat,lon],12); }
function gwReset() {
  document.querySelectorAll('.gw-pt').forEach(function(p){ p.style.display=''; });
  if (gwMap) gwMap.setView([40.5,35.0],7);
}
function gwLocate() {
  if (!navigator.geolocation) { alert('Geolocation desteklenmiyor.'); return; }
  navigator.geolocation.getCurrentPosition(function(pos) {
    if (!gwMap) return;
    if (gwUserMk) gwMap.removeLayer(gwUserMk);
    gwUserMk = L.marker([pos.coords.latitude,pos.coords.longitude])
      .addTo(gwMap).bindPopup('ğŸ“ Konumunuz').openPopup();
    gwMap.setView([pos.coords.latitude,pos.coords.longitude],10);
  }, function(){ alert('Konum alÄ±namadÄ±.'); });
}
function gwRuptures() {
  if (!gwMap) return;
  if (gwRupLayers.length) {
    gwRupLayers.forEach(function(l){ gwMap.removeLayer(l); });
    gwRupLayers = [];
  } else {
    Object.values(RUPS).forEach(function(c) {
      gwRupLayers.push(L.polyline(c,{color:'#c0392b',weight:5,opacity:.7,dashArray:'10'}).addTo(gwMap));
    });
  }
}

// â”€â”€ ARAMA â”€â”€
function gwFilter(v) {
  v = v.toLowerCase();
  document.querySelectorAll('.gw-pt').forEach(function(p) {
    p.style.display = p.dataset.s.includes(v) ? '' : 'none';
  });
}

// â”€â”€ TEMA â”€â”€
function gwTheme() {
  var app = document.getElementById('gw-app');
  var dark = app.getAttribute('data-theme') === 'dark';
  app.setAttribute('data-theme', dark ? '' : 'dark');
  document.getElementById('gw-ticon').textContent = dark ? 'ğŸŒ™' : 'â˜€ï¸';
}

// â”€â”€ SES â”€â”€
var gwAudio = new Audio(), gwPL = [
  {t:'Uzun Ä°nce Bir YoldayÄ±m', s:'https://cdn.pixabay.com/download/audio/2022/03/15/audio_sample.mp3'},
  {t:'Ã‡Ã¶kertme', s:'https://cdn.pixabay.com/download/audio/2022/04/10/audio_sample2.mp3'}
], gwTI = 0;
function gwMusic() {
  if (gwAudio.paused) {
    gwAudio.src = gwPL[gwTI].s; gwAudio.play();
    document.getElementById('gw-pbtn').textContent = 'â¸';
    document.getElementById('gw-tname').textContent = gwPL[gwTI].t;
  } else {
    gwAudio.pause();
    document.getElementById('gw-pbtn').textContent = 'â–¶';
  }
}
function gwVoice() { alert('Sesli rehber: KÄ±rÄ±lma gÃ¶Ã§Ã¼ baÅŸlÄ±yor...'); }

// â”€â”€ START (standby tÄ±klama) â”€â”€
function gwStart() {
  document.getElementById('gw-standby').style.display = 'none';
  if (gwMap) { setTimeout(function(){ gwMap.invalidateSize(); }, 200); }
  gwMusic();
}

// â”€â”€ YORUM â”€â”€
function gwShare(n) {
  if (navigator.share) { navigator.share({title:n, text:n+' â€” KAFZ Geowalk', url:location.href}); }
  else { alert(n + ' kopyalandÄ±: ' + location.href); }
}
function gwCmt(i) {
  var inp = document.getElementById('ci'+i);
  var txt = inp.value.trim(); if (!txt) return;
  var li = document.getElementById('cl'+i);
  var d = document.createElement('div');
  d.className = 'gw-citem';
  d.textContent = txt;
  li.appendChild(d);
  inp.value = '';
}
</script>

<script>
// Leaflet CSS ve JS dinamik yÃ¼kleme
(function() {
  // CSS yÃ¼kle
  var lCDNs = [
    'https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css',
    'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'
  ];
  var link = document.createElement('link');
  link.rel = 'stylesheet';
  link.href = lCDNs[0];
  link.onerror = function() { link.href = lCDNs[1]; };
  document.head.appendChild(link);

  // JS yÃ¼kle â€” 3 CDN fallback
  var jCDNs = [
    'https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js',
    'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js',
    'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js'
  ];
  var idx = 0;
  function load() {
    if (idx >= jCDNs.length) { initApp(false); return; }
    var s = document.createElement('script');
    s.src = jCDNs[idx++];
    s.onload = function() { initApp(true); };
    s.onerror = load;
    document.head.appendChild(s);
  }
  load();
})();
</script>
